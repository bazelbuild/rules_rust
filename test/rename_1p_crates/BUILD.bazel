load("//rust:defs.bzl", "rust_library", "rust_test")

rust_library(
    name = "mod1",
    srcs = ["mod1.rs"],
)

# FIXME: the targets commented out below pass iff //settings:rename_1p_crates ==
# True and //settings:third_party_dir = "//test/rename_1p_crates/my_3p_dir". We
# need to override the real values of those flags for these end-to-end tests to
# work; how to do that?

# rust_library(
#     name = "mod2",
#     srcs = ["mod2.rs"],
#     deps = [":mod1"],
# )

# rust_library(
#     name = "mod3",
#     srcs = ["mod3.rs"],
#     aliases = {
#         ":mod1": "alias_a",
#         ":mod2": "alias_b",
#     },
#     deps = [
#         ":mod1",
#         ":mod2",
#     ],
# )

# rust_library(
#     name = "mod4",
#     srcs = ["mod4.rs"],
#     deps = ["//test/rename_1p_crates/my_3p_dir:my_3p_lib"],
# )

rust_test(
    name = "mod1_test",
    crate = ":mod1",
)

# rust_test(
#     name = "mod2_test",
#     crate = ":mod2",
# )

# rust_test(
#     name = "mod3_test",
#     aliases = {
#         ":mod1": "alias_a",
#         ":mod2": "alias_b",
#     },
#     crate = ":mod3",
# )

# rust_test(
#     name = "mod4_test",
#     crate = ":mod4",
# )
