load("//cargo:defs.bzl", "cargo_build_script")
load("//rust:rust_test.bzl", "rust_test")

rust_test(
    # Intentionally uses a mix of -s and _s because those normalisations are part of what is being tested.
    name = "cargo_env-vars_test",
    srcs = ["tests/cargo.rs"],
    edition = "2018",
    deps = [":cargo_build_script_env-vars_bs"],
)

rust_test(
    name = "cargo-env-vars-custom-crate-name-test",
    srcs = ["tests/custom_crate_name.rs"],
    crate_name = "custom_crate_name",
    edition = "2018",
    deps = [":cargo_build_script_env-vars_bs"],
)

cargo_build_script(
    name = "cargo_build_script_env-vars_bs",
    srcs = ["src/build.rs"],
    edition = "2018",
)
